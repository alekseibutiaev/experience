/*
 * zx_keyboard.c
 *
 *  Created on: Nov 15, 2022
 *      Author: butiaev
 */
#include <stdio.h>
#include "main.h"
#include "zx_keyboard.h"

//#define OLD_VERSION

typedef struct {
  uint8_t treg;
  uint8_t tbit;
  uint8_t lreg;
  uint8_t lbit;
} key_layer_t;


#ifndef OLD_VERSION
#define KEYBIT_MASK 0xFF
const key_layer_t layers[256] = {
/*00*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*02*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*04*/  {0x01, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*A */ {0x07, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*B */
/*06*/  {0x00, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*C */ {0x01, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*D */
/*08*/  {0x02, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*E */ {0x01, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*F */
/*0A*/  {0x01, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*G */ {0x06, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*H */
/*0C*/  {0x05, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*I */ {0x06, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*J */
/*0E*/  {0x06, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*K */ {0x06, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*L */
/*10*/  {0x07, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*M */ {0x07, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*N */
/*12*/  {0x05, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*O */ {0x05, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*P */
/*14*/  {0x02, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*Q */ {0x02, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*R */
/*16*/  {0x01, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*S */ {0x02, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*T */
/*18*/  {0x05, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*U */ {0x00, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*V */
/*1A*/  {0x02, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*W */ {0x00, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*X */
/*1C*/  {0x05, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*Y */ {0x00, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*Z */
/*1E*/  {0x03, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*1 */ {0x03, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*2 */
/*20*/  {0x03, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*3 */ {0x03, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*4 */
/*DC*/  {0x03, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*5 */ {0x04, 0xEF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*6 */
/*24*/  {0x04, 0xF7 & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*7 */ {0x04, 0xFB & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*8 */
/*DC*/  {0x04, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*9 */ {0x04, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*0 */
/*28*/  {0x06, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*EN*/ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*2A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*2C*/  {0x07, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*SP*/ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*2E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*30*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*32*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*34*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*36*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*38*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0x00, 0xFE & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*CS*/
/*3A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*3C*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*3E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*40*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*42*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*44*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*46*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*48*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*4A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*4C*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*4E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*50*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*52*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*54*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*56*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*58*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*5A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*5C*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*5E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*60*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*62*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*64*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*66*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*68*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*6A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*6C*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*6E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*70*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*72*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*74*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*76*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*78*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*7A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*7C*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*7E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*80*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*82*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*84*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*86*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*88*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*8A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*8C*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*8E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*90*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*92*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*94*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*96*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*98*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*9A*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*9C*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*9E*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*A0*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*A2*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*A4*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*A6*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*A8*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*AA*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*AC*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*AE*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*B0*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*B2*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*B4*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*B6*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*B8*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*BA*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*BC*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*BE*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*C0*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*C2*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*C4*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*C6*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*C8*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*CA*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*DC*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*CE*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*D0*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*D2*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*D4*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*D6*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*D8*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*DA*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*DC*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*DE*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*E0*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*E2*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*E4*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*E6*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*E8*/  {0x07, 0xFD & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*SS*/ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*EA*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*EC*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*EE*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*F0*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*F2*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*F4*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*F6*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*F8*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*FA*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*FC*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
/*FE*/  {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */ {0xFF, 0xFF & KEYBIT_MASK, 0xFF, 0xFF & KEYBIT_MASK}, /*  */
};
#else
const key_layer_t layers[256] = {
/*00*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*04*/  {0xFD, 0x1E, 0xFF, 0x1F}, /*A */ {0x7F, 0x0F, 0xFF, 0x1F}, /*B */ {0xFE, 0x17, 0xFF, 0x1F}, /*C */ {0xFD, 0x1B, 0xFF, 0x1F}, /*D */
/*08*/  {0xFB, 0x1B, 0xFF, 0x1F}, /*E */ {0xFD, 0x17, 0xFF, 0x1F}, /*F */ {0xFD, 0x0F, 0xFF, 0x1F}, /*G */ {0xBF, 0x0F, 0xFF, 0x1F}, /*H */
/*0C*/  {0xDF, 0x1B, 0xFF, 0x1F}, /*I */ {0xBF, 0x17, 0xFF, 0x1F}, /*J */ {0xBF, 0x1B, 0xFF, 0x1F}, /*K */ {0xBF, 0x1D, 0xFF, 0x1F}, /*L */
/*10*/  {0x7F, 0x1B, 0xFF, 0x1F}, /*M */ {0x7F, 0x17, 0xFF, 0x1F}, /*N */ {0xDF, 0x1D, 0xFF, 0x1F}, /*O */ {0xDF, 0x1E, 0xFF, 0x1F}, /*P */
/*14*/  {0xFB, 0x1E, 0xFF, 0x1F}, /*Q */ {0xFB, 0x17, 0xFF, 0x1F}, /*R */ {0xFD, 0x1D, 0xFF, 0x1F}, /*S */ {0xFB, 0x0F, 0xFF, 0x1F}, /*T */
/*18*/  {0xDF, 0x17, 0xFF, 0x1F}, /*U */ {0xFE, 0x0F, 0xFF, 0x1F}, /*V */ {0xFB, 0x1D, 0xFF, 0x1F}, /*W */ {0xFE, 0x1B, 0xFF, 0x1F}, /*X */
/*1C*/  {0xDF, 0x0F, 0xFF, 0x1F}, /*Y */ {0xFE, 0x1D, 0xFF, 0x1F}, /*Z */ {0xF7, 0x1E, 0xFF, 0x1F}, /*1 */ {0xF7, 0x1D, 0xFF, 0x1F}, /*2 */
/*20*/  {0xF7, 0x1B, 0xFF, 0x1F}, /*3 */ {0xF7, 0x17, 0xFF, 0x1F}, /*4 */ {0xF7, 0x0F, 0xFF, 0x1F}, /*5 */ {0xEF, 0x0F, 0xFF, 0x1F}, /*6 */
/*24*/  {0xEF, 0x17, 0xFF, 0x1F}, /*7 */ {0xEF, 0x1B, 0xFF, 0x1F}, /*8 */ {0xEF, 0x1D, 0xFF, 0x1F}, /*9 */ {0xEF, 0x1E, 0xFF, 0x1F}, /*0 */
/*28*/  {0xBF, 0x1E, 0xFF, 0x1F}, /*EN*/ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*2C*/  {0x7F, 0x1E, 0xFF, 0x1F}, /*SP*/ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*30*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*34*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*38*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFE, 0x1E, 0xFF, 0x1F}, /*CS*/ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*3C*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*40*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*44*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*48*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*4C*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*50*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*54*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*58*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*5C*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*60*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*64*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*68*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*6C*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*70*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*74*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*78*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*7C*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*80*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*84*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*88*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*8C*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*90*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*94*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*98*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*9C*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*A0*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*A4*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*A8*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*AC*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*B0*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*B4*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*B8*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*BC*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*C0*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*C4*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*C8*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*DC*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*D0*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*D4*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*D8*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*DC*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*E0*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*E4*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*E8*/  {0x7F, 0x1D, 0xFF, 0x1F}, /*SS*/ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*EC*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*F0*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*F4*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*F8*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
/*FC*/  {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */ {0xFF, 0x1F, 0xFF, 0x1F}, /*  */
};
#endif

int ts = 0;
uint8_t table[2][256] = {0};

void printbuf(const uint8_t* buf, const uint32_t size) {
  for(uint32_t i = 0; i < size; ++i)
    printf("0x%02X%c%c", buf[i], (buf[i] == KEYDATA_MASK ? ' ' : '*'), ((i + 1) % 16 ? ' ' : '\n'));
}

void build_registr(uint8_t (*keyreg)[8], const uint8_t(*keys)[6]) {
  for(int i = 0; i < sizeof(*keys) && (*keys)[i]; ++i) {
    const key_layer_t* kl = layers + (*keys)[i];
    (*keyreg)[kl->treg] &= kl->tbit;
  }
}

uint8_t assemply_data(const uint8_t(*regs)[8],const uint8_t addr) {
  uint8_t res = 0xFF;
  if(addr & 0x01)
    res &= (*regs)[0];
  if(addr & 0x02)
    res &= (*regs)[1];
  if(addr & 0x04)
    res &= (*regs)[2];
  if(addr & 0x08)
    res &= (*regs)[3];
  if(addr & 0x10)
    res &= (*regs)[4];
  if(addr & 0x20)
    res &= (*regs)[5];
  if(addr & 0x40)
    res &= (*regs)[6];
  if(addr & 0x80)
    res &= (*regs)[7];
  return res;
}

void build_key_table(uint8_t(*table1)[256], const uint8_t(*keys)[6]) {
  uint8_t regs[8] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};
  build_registr(&regs, keys);
  for(int i = 0; i < sizeof(*table1); ++i)
    (*table1)[i] = assemply_data(&regs, ~(uint8_t)i);
  return;
}

void prepare_keys(const key_receive_t* keys, const key_leds_t* leds) {
  static key_receive_t previous = {0};
#if 1
  printf("lc = %d,ls = %d, la = %d, lg = %d, rc = %d, rs = %d, ra = %d, rg = %d, "
    "k0 = 0x%02X, k1 = 0x%02X, k2 = 0x%02X, k3 = 0x%02X, k4 = 0x%02X, k5 = 0x%02X\n",
    (int)keys->data.mod.bits.lctrl, (int)keys->data.mod.bits.lshift,
    (int)keys->data.mod.bits.lalt, (int)keys->data.mod.bits.lgui,
    (int)keys->data.mod.bits.rctrl, (int)keys->data.mod.bits.rshift,
    (int)keys->data.mod.bits.ralt, (int)keys->data.mod.bits.rgui,
    (int)keys->data.keys[0], (int)keys->data.keys[1], (int)keys->data.keys[2],
    (int)keys->data.keys[3], (int)keys->data.keys[4], (int)keys->data.keys[5]);
#endif
#ifndef OLD_VERSION
  build_key_table(&table[ts ? 0 : 1], &keys->data.keys);
  ts = ts ? 0 : 1;
//  printbuf(table, 256);
#else
  if(keys->data.mod.bits.lshift | keys->data.mod.bits.rshift)
    table[layers[SYMBOL_SHIFT].treg] &= layers[SYMBOL_SHIFT].tbit;
  else
    table[layers[SYMBOL_SHIFT].treg] |= KEYDATA_MASK;
  for(int i = 0; i < sizeof(keys->data.keys); ++i) {
    if(0 == memchr(previous.data.keys, keys->data.keys[i], sizeof(previous.data.keys)))
      table[layers[keys->data.keys[i]].treg] &= layers[keys->data.keys[i]].tbit;
    if(0 == memchr(keys->data.keys, previous.data.keys[i], sizeof(keys->data.keys)))
      table[layers[previous.data.keys[i]].treg] |= KEYDATA_MASK;
  }
#endif
//  printbuf(zx_keyboards, sizeof(zx_keyboards));
  memcpy(&previous, keys, sizeof(key_receive_t));
}

